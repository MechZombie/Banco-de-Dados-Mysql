-- CRIANDO TABLE PARA USO DAS PROCEDURES --
CREATE TABLE CURSOS (

	IDCURSO INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR(30) NOT NULL,
	HORAS INT(3) NOT NULL,
	VALOR FLOAT(10,2) NOT NULL

);

-- CRIANDO PROCEDURE DE INSERÇÃO --
DELIMITER $
CREATE PROCEDURE CAD_CURSO(P_NOME VARCHAR(30),P_HORAS INT(3),P_PRECO FLOAT(10,2))
BEGIN
    INSERT INTO CURSOS VALUES(NULL,P_NOME,P_HORAS,P_PRECO);
END
$

--CRIANDO PROCEDURE DE LEITURA--
DELIMITER $
CREATE PROCEDURE SEL_CURSO()
BEGIN
    SELECT IDCURSO, NOME,HORAS,VALOR
    FROM CURSOS;
END
$

-- CHAMANDO AS PROCEDURES--

CALL CAD_CURSO('JAVA',40,150.00);
CALL SEL_CURSO();


-- CRIANDO DATABASE--
CREATE DATABASE COMERCIO;
-- CRIANDO TABLE--

CREATE TABLE VENDEDORES(
	IDVENDEDOR INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR(30),
	SEXO CHAR(1),
	JANEIRO FLOAT(10,2),
	FEVEREIRO FLOAT(10,2),
	MARCO FLOAT(10,2)
);

INSERT INTO VENDEDORES VALUES(NULL,'ANDRE','M',123.00,123.00,123.00);
INSERT INTO VENDEDORES VALUES(NULL,'CARLOS','M',143.00,183.00,23.00);
INSERT INTO VENDEDORES VALUES(NULL,'PAULO','M',623.00,153.00,923.00);
INSERT INTO VENDEDORES VALUES(NULL,'CLAUDIA','F',423.00,123.00,223.00);
INSERT INTO VENDEDORES VALUES(NULL,'ANDREIA','F',723.00,623.00,223.00);

DELIMITER $
CREATE PROCEDURE CAD_VENDEDOR(P_NOME VARCHAR(30),P_SEXO CHAR(1),P_JAN FLOAT(10,2),P_FEV FLOAT(10,2),P_MARCO FLOAT)(10,2)
BEGIN
	INSERT INTO VENDEDORES VALUES(NULL,P_NOME,P_SEXO,P_JAN,P_FEV,P_MARCO);

END
$
DELIMITER ;


-- FUNÇÕES DE COLUNA--

--BANCO DE DADOS MYSQL--

-- FUNÇAO MAX
SELECT MAX(FEVEREIRO) AS MAIOR_FEV
FROM VENDEDORES;

-- FUNÇÃO MIN
SELECT MIN(FEVEREIRO) AS MENOR_FEV
FROM VENDEDORES;

-- FUNCAO AVG
SELECT AVG(FEVEREIRO) AS MEDIA_FEV
FROM VENDEDORES;
-- FUNÇOES ENCADEADAS

SELECT MAX(FEVEREIRO)AS MAIOR_FEV,
		MIN(FEVEREIRO)AS MENOR_FEV,
		TRUNCATE(AVG(FEVEREIRO),2)AS MEDIA_FEV
		FROM VENDEDORES;

-- FUNÇÃO SUM--RETORNA A SOMA DOS VALORES

SELECT TRUNCATE(SUM(FEVEREIRO),1)AS TOTAL
FROM VENDEDORES;

-- GROUP BY

SELECT SEXO ,TRUNCATE(SUM(JANEIRO),1)AS TOTAL_JAN
FROM VENDEDORES
GROUP BY SEXO;

-- SUBQUERY / INNERQUERY
--TRAZ O NOME E O MES, FILTRANDO PELO MENOR VALOR DE MARCO
-- AS SUBQUERY SÃO EXECUTADAS PRIMEIRO

SELECT NOME, MARCO FROM VENDEDORES
WHERE MARCO = (SELECT MIN(MARCO)FROM VENDEDORES);

-- RETORNA AQUELE QUE SEJA MAIOR QUE A MÉDIA
SELECT NOME, MARCO FROM VENDEDORES
WHERE MARCO > ( SELECT AVG(MARCO)FROM VENDEDORES);
